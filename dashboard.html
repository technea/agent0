<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenClaw Agent - Live Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"
        type="application/javascript"></script>
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: rgba(22, 27, 34, 0.8);
            --accent-color: #58a6ff;
            --success-color: #238636;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --border-color: #30363d;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1000px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: var(--card-bg);
            padding: 20px 30px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        h1 {
            margin: 0;
            font-size: 24px;
            background: linear-gradient(90deg, #58a6ff, #bc8cff);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(35, 134, 54, 0.2);
            color: #3fb950;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background-color: #3fb950;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(63, 185, 80, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(63, 185, 80, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(63, 185, 80, 0);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .token-list {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .list-header {
            padding: 15px 25px;
            background: rgba(48, 54, 61, 0.3);
            border-bottom: 1px solid var(--border-color);
            font-weight: bold;
            color: var(--text-secondary);
        }

        .token-item {
            padding: 20px 25px;
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 1fr 1fr 1.5fr 1fr;
            align-items: center;
            transition: background 0.2s;
        }

        .token-item:hover {
            background: rgba(48, 54, 61, 0.1);
        }

        .token-item:last-child {
            border-bottom: none;
        }

        .token-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .token-symbol {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .token-timestamp {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .token-link {
            text-decoration: none;
            color: var(--accent-color);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .token-link:hover {
            text-decoration: underline;
        }

        .reputation-badge {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            padding: 3px 8px;
            border-radius: 4px;
            color: #000;
            font-weight: bold;
            font-size: 12px;
        }

        #empty-state {
            padding: 50px;
            text-align: center;
            color: var(--text-secondary);
        }

        .footer {
            margin-top: 50px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <div>
                <h1>OpenClaw Dashboard</h1>
                <p style="margin: 5px 0 0; font-size: 14px; color: var(--text-secondary);">Autonomous Agent0 / ERC-8004
                    Operator</p>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <button id="connect-wallet" onclick="connectWallet()"
                    style="padding: 6px 15px; background: transparent; border: 1px solid var(--accent-color); color: var(--accent-color); border-radius: 20px; cursor: pointer; font-weight: 600; font-size: 13px;">Connect
                    Wallet</button>
                <div class="status-badge">
                    <div class="status-dot"></div>
                    Agent Live
                </div>
            </div>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="total-deployments">0</div>
                <div class="stat-label">Total Tokens</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="reputation-score">0</div>
                <div class="stat-label">Reputation Score</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="user-address"
                    style="font-size: 14px; overflow: hidden; text-overflow: ellipsis;">No Wallet</div>
                <div class="stat-label">Your Wallet</div>
            </div>
        </div>

        <!-- Command Center -->
        <div class="token-list" style="margin-bottom: 30px; padding: 25px; background: rgba(88, 166, 255, 0.05);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: var(--accent-color);">üéÆ Agent Command Center</h3>
                <span id="deployment-mode" style="font-size: 12px; color: var(--text-secondary);">Mode: Agent
                    Autonomous</span>
            </div>
            <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
                <div style="flex: 1; min-width: 200px;">
                    <label
                        style="display: block; font-size: 12px; margin-bottom: 5px; color: var(--text-secondary);">Custom
                        Token Name</label>
                    <input type="text" id="custom-name" placeholder="e.g. SatoshiToken"
                        style="width: 100%; padding: 10px; background: #0d1117; border: 1px solid var(--border-color); color: white; border-radius: 6px;">
                </div>
                <div style="width: 120px;">
                    <label
                        style="display: block; font-size: 12px; margin-bottom: 5px; color: var(--text-secondary);">Symbol</label>
                    <input type="text" id="custom-symbol" placeholder="SAT"
                        style="width: 100%; padding: 10px; background: #0d1117; border: 1px solid var(--border-color); color: white; border-radius: 6px;">
                </div>
                <button onclick="agentDesignToken()"
                    style="padding: 10px; background: rgba(88,166,255,0.1); border: 1px dashed var(--accent-color); color: var(--accent-color); border-radius: 6px; cursor: pointer; font-size: 12px;">ü™Ñ
                    Agent Suggest</button>
                <button id="deploy-btn" onclick="handleDeploy()"
                    style="padding: 10px 20px; background: var(--success-color); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üöÄ
                    Deploy Token</button>
                <button id="batch-deploy-btn" onclick="handleBatchDeploy()"
                    style="padding: 10px 20px; background: linear-gradient(135deg, #8a2be2, #4b0082); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üíé
                    Batch Deploy 5 (Agent Design)</button>
            </div>
        </div>

        <div style="margin-top: 20px;">
            <label style="display: block; font-size: 12px; margin-bottom: 5px; color: var(--text-secondary);">Custom
                Farcaster Post</label>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <textarea id="custom-message" placeholder="What should the agent say on Farcaster?"
                    style="width: 100%; padding: 10px; background: #0d1117; border: 1px solid var(--border-color); color: white; border-radius: 6px; resize: none; height: 60px;"></textarea>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="image-url" placeholder="Image URL (optional)"
                        style="flex: 1; padding: 10px; background: #0d1117; border: 1px solid var(--border-color); color: white; border-radius: 6px;">
                    <button onclick="sendCommand('post')"
                        style="padding: 10px 20px; background: var(--accent-color); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üì¢
                        Manual Cast</button>
                </div>
            </div>
        </div>

        <p id="command-status" style="margin: 10px 0 0; font-size: 12px; color: #3fb950; display: none;">‚úÖ Command
            Sent!</p>
    </div>

    <div class="token-list">
        <div class="list-header">Deployment History</div>
        <div id="deployment-history">
            <div id="empty-state">No deployments found. Starting cycle...</div>
        </div>
    </div>

    <div class="footer">
        Powered by Agent0 SDK & ERC-8004 Standard ‚Ä¢ Base Sepolia Network
    </div>
    </div>

    <script>
        let userAddress = null;
        let provider = null;
        let signer = null;

        const ERC20_ABI = [
            "constructor(string name, string symbol, uint256 initialSupply)",
            "function name() view returns (string)",
            "function symbol() view returns (string)",
            "function totalSupply() view returns (uint256)",
            "function balanceOf(address) view returns (uint256)",
            "function transfer(address to, uint256 amount) returns (bool)",
            "event Transfer(address indexed from, address indexed to, uint256 value)"
        ];

        const ERC20_BYTECODE = "0x60806040523480156200001157600080fd5b5060405162000e9638038062000e968339818101604052810190620000379190620002e4565b82600390816200004891906200058a565b5081600490816200005a91906200058a565b508060058190555080600080620000766200012960201b60201c565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508073ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040516200011591906200067c565b60405180910390a3505050620006b9565b600033905090565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6200019a826200014f565b810181811067ffffffffffffffff82111715620001bc57620001bb62000160565b5b80604052505050565b6000620001d162000131565b9050620001df82826200018f565b919050565b600067ffffffffffffffff82111562000202576200020162000160565b5b6200020d826200014f565b9050602081019050919050565b60005b838110156200023a5780820151818401526020810190506200021d565b60008484015250505050565b60006200025d6200025784620001e4565b620001c5565b9050828152602081018484840111156200027c576200027b6200014a565b5b620002898482856200021a565b509392505050565b600082601f830112620002a957620002a862000145565b5b8151620002bb84826020860162000246565b91505092915050565b6000819050919050565b620002d981620002c4565b8114620002e557600080fd5b50565b600080600060608486031215620002fe57620002fd6200013b565b5b600084015167ffffffffffffffff8111156200031f576200031e62000140565b5b6200032d8682870162000291565b935050602084015167ffffffffffffffff81111562000351576200035062000140565b5b6200035f8682870162000291565b92505060406200037286828701620002ce565b9150509250925092565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680620003cf57607f821691505b602082108103620003e557620003e462000387565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026200044f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8262000410565b6200045b868362000410565b95508019841693508086168417925050509392505050565b6000819050919050565b60006200049e620004986200049284620002c4565b62000473565b620002c4565b9050919050565b6000819050919050565b620004ba836200047d565b620004d2620004c982620004a5565b8484546200041d565b825550505050565b600090565b620004e9620004da565b620004f6818484620004af565b505050565b5b818110156200051e5762000512600082620004df565b600181019050620004fc565b5050565b601f8211156200056d576200053781620003eb565b6200054284620003fc565b8101602085101562000552578190505b6200056a6200056185620003fc565b830182620004fb565b50505b505050565b600082821c905092915050565b6000620005926000198460080262000572565b1980831691505092915050565b6000620005ad83836200057f565b9150826002028217905092915050565b620005c8826200037c565b67ffffffffffffffff811115620005e457620005e362000160565b5b620005f08254620003b6565b620005fd82828562000522565b600060209050601f83116001811462000635576000841562000620578287015190505b6200062c85826200059f565b8655506200069c565b601f1984166200064586620003eb565b60005b828110156200066f5784890151825560018201915060208501945060208101905062000648565b868310156200068f57848901516200068b601f8916826200057f565b8355505b6001600288020188555050505b505050505050565b620006af81620002c4565b82525050565b6000602082019050620006cc6000830184620006a4565b92915050565b6107cd80620006e26000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c806306fdde031461005c57806318160ddd1461007a57806370a082311461009857806395d89b41146100c8578063a9059cbb146100e6575b600080fd5b610064610116565b6040516100719190610455565b60405180910390f35b6100826101a4565b60405161008f91906104a0565b60405180910390f35b6100b260048036038101906100ad91906104f1565b6101aa565b6040516100bf91906104a0565b60405180910390f35b6100d06101f2565b6040516100dd9190610455565b60405180910390f35b61010060048036038101906100fb919061051e565b610280565b60405161010d919061058d565b60405180910390f35b6003805461012390610637565b80601f016020809104026020016040519081016040528092919081815260200182805461014f90610637565b801561019c5780601f106101715761010080835404028352916020019161019c565b820191906000526020600020905b81548152906001019060200180831161017f57829003601f168201915b505050505081565b60055481565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b600480546101ff90610637565b80601f016020809104026020016040519081016040528092919081815260200182805461022b90610637565b80156102785780601f1061024d57610100808354040283529160200191610278565b820191906000526020600020905b81548152906001019060200180831161025b57829003601f168201915b505050505081565b60008160008061028e6103e9565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101561030a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610301906106c9565b60405180910390fd5b816000806103166103e9565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461035e91906106e9565b925050819055508160008085736ffffffffffffffff81167fffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825461039e91906107f6565b925050819055508273ffffffffffffffffffffffffffffffffffffffff166103c46103e9565b73ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040516103da91906104a0565b60405180910390a36001905092915050565b600033905090565b600081519050919050565b600082825260208201905092915050565b60005b8381101561042b578082015181840152602081019050610410565b60008484015250505050565b6000601f19601f8301169050919050565b6000610453826103f1565b61045d81856103fc565b935061046d81856020860161040d565b61047681610437565b840191505092915050565b6000819050919050565b61049a81610481565b82525050565b600060208201905081810360008301526104ba8184610448565b905092915050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006104f2826104c7565b9050919050565b610502816104e7565b811461050d57600080fd5b50565b60008135905061051f816104f9565b92915050565b60008060408385031215610535576105346104c2565b5b600061054385828601610510565b925050602061055485828601610510565b9150509250929050565b60008115159050919050565b6105738161055e565b82525050565b600060208201905061058e600083018461056a565b9291505056fea2646970667358221220abcdef1234567890abcdef1234567890abcdef1234567890abcdef123456789064736f6c63430008120033";

        function agentDesignToken() {
            const prefixes = ["Open", "Base", "Claw", "Auto", "Chain", "Mesh", "Cyber", "Meta", "Hyper", "Ultra", "Mega", "Nova", "Apex", "Quantum", "Nexus"];
            const suffixes = ["Token", "Coin", "Cash", "Finance", "Pay", "Network", "Protocol", "Chain", "Swap", "Vault", "DAO", "Labs"];

            const name = prefixes[Math.floor(Math.random() * prefixes.length)] + suffixes[Math.floor(Math.random() * suffixes.length)];
            const symbol = (name[0] + name[name.length - 2] + name[name.length - 1]).toUpperCase();

            document.getElementById('custom-name').value = name;
            document.getElementById('custom-symbol').value = symbol;

            const status = document.getElementById('command-status');
            status.textContent = "ü™Ñ Agent suggested: " + name;
            status.style.display = 'block';
            setTimeout(() => status.style.display = 'none', 3000);
        }

        async function connectWallet() {
            console.log("Connect Wallet clicked");
            if (typeof window.ethereum !== 'undefined') {
                try {
                    console.log("Ethereum provider found, requesting accounts...");
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    const accounts = await provider.send("eth_requestAccounts", []);
                    signer = provider.getSigner();
                    userAddress = accounts[0];
                    console.log("Connected address:", userAddress);

                    document.getElementById('user-address').textContent = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                    document.getElementById('connect-wallet').textContent = 'Connected';
                    document.getElementById('connect-wallet').style.background = 'var(--success-color)';
                    document.getElementById('deployment-mode').textContent = 'Mode: User Manual (connected)';
                } catch (error) {
                    console.error("Connection error:", error);
                    alert("Connection failed: " + error.message);
                }
            } else {
                console.warn("MetaMask not found");
                alert("Please install MetaMask or a Web3 wallet extension!");
            }
        }

        async function handleDeploy() {
            if (userAddress && signer) {
                await deployFromUserWallet();
            } else {
                await sendCommand('deploy');
            }
        }

        async function deployFromUserWallet() {
            const name = document.getElementById('custom-name').value || "UserToken";
            const symbol = document.getElementById('custom-symbol').value || "UTK";
            const status = document.getElementById('command-status');
            const btn = document.getElementById('deploy-btn');

            if (!name || !symbol) {
                alert("Please provide name and symbol");
                return;
            }

            try {
                // Network Check
                const { chainId } = await provider.getNetwork();
                console.log("Current Chain ID:", chainId);

                if (chainId !== 8453 && chainId !== 84532) {
                    alert("Please switch your wallet to Base Mainnet (8453) or Base Sepolia (84532)!");
                    return;
                }

                btn.disabled = true;
                btn.textContent = "‚åõ Deploying...";
                status.textContent = "‚è≥ Signing Transaction...";
                status.style.display = 'block';

                const factory = new ethers.ContractFactory(ERC20_ABI, ERC20_BYTECODE, signer);

                // Use a smaller initial supply and handle gas
                const initialSupply = ethers.utils.parseUnits("1000000", 18);

                const contract = await factory.deploy(name, symbol, initialSupply, {
                    gasLimit: 1500000 // Ensure enough gas for deployment
                });

                status.textContent = "‚è≥ Waiting for Confirmation (Tx: " + contract.deployTransaction.hash.substring(0, 10) + "...)";

                await contract.deployed();

                status.textContent = "‚úÖ " + name + " Deployed at " + contract.address;
                document.getElementById('custom-name').value = '';
                document.getElementById('custom-symbol').value = '';

                setTimeout(() => {
                    status.style.display = 'none';
                }, 15000);

            } catch (error) {
                console.error("Deployment failed", error);
                status.textContent = "‚ùå Error: " + (error.data?.message || error.message || "Unknown Error");
                status.style.background = "rgba(255, 0, 0, 0.1)";
                status.style.color = "#ff4a4a";
                alert("Deployment failed! Check status bar for details.");
            } finally {
                btn.disabled = false;
                btn.textContent = "üöÄ Deploy Token";
            }
        }

        async function handleBatchDeploy() {
            if (!userAddress || !signer) {
                alert("Please connect your wallet first!");
                return;
            }

            const status = document.getElementById('command-status');
            const btn = document.getElementById('batch-deploy-btn');

            try {
                // Check Balance (0.1$ is approx 0.00004 ETH)
                const balance = await provider.getBalance(userAddress);
                const minBalance = ethers.utils.parseEther("0.00004");

                if (balance.lt(minBalance)) {
                    alert("Insufficient Balance! You need at least 0.1$ (approx 0.00004 ETH) for gas.");
                    return;
                }

                if (!confirm("Agent will design and deploy 5 tokens from your wallet. Continue?")) return;

                btn.disabled = true;
                btn.textContent = "‚åõ Batch Processing...";
                status.style.display = 'block';

                for (let i = 1; i <= 5; i++) {
                    // Agent Designs the token
                    const prefixes = ["Open", "Base", "Claw", "Auto", "Chain", "Mesh", "Cyber", "Meta", "Hyper", "Ultra", "Mega", "Nova", "Apex", "Quantum", "Nexus"];
                    const suffixes = ["Token", "Coin", "Cash", "Finance", "Pay", "Network", "Protocol", "Chain", "Swap", "Vault", "DAO", "Labs"];
                    const name = prefixes[Math.floor(Math.random() * prefixes.length)] + suffixes[Math.floor(Math.random() * suffixes.length)];
                    const symbol = (name[0] + name[name.length - 2] + name[name.length - 1]).toUpperCase();

                    status.textContent = `üöÄ Processing ${i}/5: Deploying ${name}...`;

                    const factory = new ethers.ContractFactory(ERC20_ABI, ERC20_BYTECODE, signer);
                    const initialSupply = ethers.utils.parseUnits("1000000", 18);

                    const contract = await factory.deploy(name, symbol, initialSupply, {
                        gasLimit: 1200000
                    });

                    status.textContent = `‚è≥ Waiting for #${i} Confirmation...`;
                    await contract.deployed();
                    console.log(`Token ${i} deployed at:`, contract.address);
                }

                status.textContent = "‚úÖ All 5 Agent-Designed Tokens Deployed Successfully!";
                status.style.background = "rgba(35, 134, 54, 0.2)";

            } catch (error) {
                console.error("Batch Failed", error);
                status.textContent = "‚ùå Batch Error: " + (error.message || "Unknown Error");
                status.style.background = "rgba(255, 0, 0, 0.1)";
            } finally {
                btn.disabled = false;
                btn.textContent = "üíé Batch Deploy 5 (Agent Design)";
                updateDashboard();
            }
        }

        async function sendCommand(type) {
            const name = document.getElementById('custom-name').value;
            const symbol = document.getElementById('custom-symbol').value;
            const text = document.getElementById('custom-message').value;
            const image_url = document.getElementById('image-url').value;
            const status = document.getElementById('command-status');

            try {
                const response = await fetch('/api/command', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        type: type,
                        params: { name, symbol, text, image_url }
                    })
                });

                if (response.ok) {
                    status.style.display = 'block';
                    setTimeout(() => status.style.display = 'none', 3000);
                    if (type === 'deploy') {
                        document.getElementById('custom-name').value = '';
                        document.getElementById('custom-symbol').value = '';
                    } else if (type === 'post') {
                        document.getElementById('custom-message').value = '';
                        document.getElementById('image-url').value = '';
                    }
                }
            } catch (e) {
                console.error('Command failed', e);
            }
        }

        async function updateDashboard() {
            try {
                const depResponse = await fetch('deployments.json');
                const deployments = await depResponse.json();

                let metadata = { agent_id: '...', reputation: 0 };
                try {
                    const metaResponse = await fetch('agent0_metadata.json');
                    metadata = await metaResponse.json();
                } catch (e) { }

                document.getElementById('total-deployments').textContent = deployments.length;
                document.getElementById('reputation-score').textContent = deployments.length;

                const historyEl = document.getElementById('deployment-history');
                if (deployments.length > 0) {
                    historyEl.innerHTML = '';
                    [...deployments].reverse().forEach(dep => {
                        const date = new Date(dep.timestamp).toLocaleString();
                        const row = document.createElement('div');
                        row.className = 'token-item';
                        row.innerHTML = `
                            <div>
                                <div class="token-name">${dep.token_name || dep.name}</div>
                                <div class="token-symbol">$${dep.token_symbol || dep.symbol}</div>
                            </div>
                            <div class="token-timestamp">${date}</div>
                            <div>
                                <span class="reputation-badge">Verified Proof</span>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Tx: ${dep.transaction_hash.substring(0, 10)}...</div>
                            </div>
                            <div>
                                <a href="${dep.explorer_url || ('https://basescan.org/tx/' + dep.transaction_hash)}" target="_blank" class="token-link">View Explorer ‚Üó</a>
                            </div>
                        `;
                        historyEl.appendChild(row);
                    });
                }
            } catch (error) {
                console.error('Error updating dashboard:', error);
            }
        }

        updateDashboard();
        setInterval(updateDashboard, 5000);
    </script>
</body>

</html>