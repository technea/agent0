<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenClaw Agent - Live Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"
        type="application/javascript"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: rgba(22, 27, 34, 0.7);
            --accent-color: #58a6ff;
            --accent-gradient: linear-gradient(135deg, #58a6ff 0%, #bc8cff 100%);
            --success-color: #238636;
            --error-color: #f85149;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --border-color: rgba(48, 54, 61, 0.6);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            box-sizing: border-box;
            transition: all 0.2s ease-in-out;
        }

        body {
            background-color: var(--bg-color);
            background-image:
                radial-gradient(circle at 10% 20%, rgba(88, 166, 255, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(188, 140, 255, 0.05) 0%, transparent 40%);
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            margin: 0;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 1100px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            /* Better vertical breathing room */
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            padding: 25px 35px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .header-title-group h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            text-align: left;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: var(--accent-gradient);
            opacity: 0.5;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
            display: block;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 600;
        }

        .command-center {
            background: rgba(88, 166, 255, 0.03);
            border: 1px solid var(--accent-color);
            border-radius: 24px;
            padding: 35px;
            position: relative;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input {
            background: rgba(13, 17, 23, 0.8);
            border: 1px solid var(--border-color);
            color: white;
            padding: 14px 18px;
            border-radius: 12px;
            font-family: inherit;
            font-size: 15px;
            outline: none;
        }

        input:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
        }

        button {
            padding: 14px 24px;
            border-radius: 12px;
            font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 14px;
        }

        button[onclick*="connectWallet"] {
            background: transparent;
            border: 1.5px solid var(--accent-color);
            color: var(--accent-color);
            padding: 8px 20px;
            border-radius: 30px;
        }

        button[onclick*="connectWallet"]:hover {
            background: var(--accent-color);
            color: white;
        }

        #deploy-btn {
            background: var(--success-color);
            color: white;
            box-shadow: 0 4px 12px rgba(35, 134, 54, 0.3);
        }

        #batch-deploy-btn {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(188, 140, 255, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            filter: brightness(1.1);
        }

        button:active {
            transform: translateY(0);
        }

        .token-list {
            background: var(--card-bg);
            border-radius: 24px;
            border: 1px solid var(--glass-border);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .list-header {
            padding: 20px 35px;
            background: rgba(48, 54, 61, 0.4);
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-weight: 700;
            color: var(--text-secondary);
        }

        .token-item {
            padding: 25px 35px;
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 1.2fr 1fr 1.5fr 1fr;
            align-items: center;
            gap: 20px;
        }

        .token-item:hover {
            background: rgba(255, 255, 255, 0.03);
            cursor: pointer;
        }

        .token-name {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }

        .reputation-badge {
            background: var(--accent-gradient);
            padding: 4px 12px;
            border-radius: 6px;
            color: white;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
        }

        .token-item:last-child {
            border-bottom: none;
        }

        .token-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .token-symbol {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .token-timestamp {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .token-link {
            text-decoration: none;
            color: var(--accent-color);
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .token-link:hover {
            text-decoration: underline;
        }

        .reputation-badge {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            padding: 3px 8px;
            border-radius: 4px;
            color: #000;
            font-weight: bold;
            font-size: 12px;
        }

        #empty-state {
            padding: 50px;
            text-align: center;
            color: var(--text-secondary);
        }

        .footer {
            margin-top: 50px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-title-group">
                <h1>OpenClaw Intelligence</h1>
                <p style="margin: 5px 0 0; font-size: 14px; color: var(--text-secondary);">Autonomous Agent0 ‚Ä¢ Real-time
                    On-chain Operator</p>
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <button id="connect-wallet" onclick="connectWallet()">üí≥ Connect Wallet</button>
                <div class="status-badge"
                    style="background: rgba(35, 134, 54, 0.15); color: #3fb950; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 30px; font-weight: 600; font-size: 13px; border: 1px solid rgba(63, 185, 80, 0.2);">
                    <div class="status-dot"></div>
                    Agent Active
                </div>
            </div>
        </header>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-value" id="total-deployments">0</span>
                <span class="stat-label">Deployments</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="reputation-score">0</span>
                <span class="stat-label">Reputation Score</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="user-address" style="font-size: 16px; font-family: monospace;">No
                    Wallet</span>
                <span class="stat-label">Active Connection</span>
            </div>
        </div>

        <!-- Command Center -->
        <div class="command-center">
            <div class="section-header">
                <h3 class="section-title">üéÆ Agent Command Center</h3>
                <span id="deployment-mode"
                    style="font-size: 12px; color: var(--text-secondary); background: rgba(255,255,255,0.05); padding: 4px 12px; border-radius: 20px;">Mode:
                    Autonomous</span>
            </div>

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <label style="font-size: 12px; color: var(--text-secondary); font-weight: 600;">TOKEN NAME</label>
                    <input type="text" id="custom-name" placeholder="e.g. SatoshiToken">
                </div>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <label style="font-size: 12px; color: var(--text-secondary); font-weight: 600;">SYMBOL</label>
                    <input type="text" id="custom-symbol" placeholder="SAT">
                </div>
                <div style="display: flex; gap: 10px; align-items: flex-end;">
                    <button onclick="agentDesignToken()"
                        style="background: rgba(88,166,255,0.1); border: 1px dashed var(--accent-color); color: var(--accent-color); flex: 1;">ü™Ñ
                        Suggest</button>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <button id="mainnet-pay-btn" onclick="payAndDeploy()"
                    style="background: var(--accent-gradient); color: white; padding: 18px; border-radius: 16px; font-size: 16px; box-shadow: 0 10px 20px rgba(88, 166, 255, 0.2);">
                    üöÄ Deploy 7 Verified Contracts ($1)
                </button>
                <button id="sepolia-free-btn" onclick="handleDeploy()"
                    style="background: rgba(255,255,255,0.05); color: white; border: 1px solid var(--border-color); padding: 18px; border-radius: 16px;">
                    üß™ Free Sepolia Test (5 Tokens)
                </button>
            </div>

            <button id="batch-deploy-btn" onclick="handleBatchDeploy()"
                style="width: 100%; margin-bottom: 20px; opacity: 0.8; font-size: 12px;">üíé Batch Deploy 5 (Agent AI
                Designs - Manual Wallet)</button>

            <div style="border-top: 1px solid var(--border-color); padding-top: 20px;">
                <label
                    style="display: block; font-size: 12px; margin-bottom: 8px; color: var(--text-secondary); font-weight: 600;">SOCIAL
                    BROADCAST (FARCASTER)</label>
                <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px;">
                    <textarea id="custom-message" placeholder="What should the agent say?"
                        style="background: rgba(13,17,23,0.8); border: 1px solid var(--border-color); color: white; padding: 12px; border-radius: 12px; resize: none; font-family: inherit; grid-column: 1 / span 2; height: 80px;"></textarea>
                    <input type="text" id="image-url" placeholder="Image URL (optional)">
                    <button onclick="sendCommand('post')" style="background: var(--accent-color); color: white;">üì¢ Cast
                        Now</button>
                </div>
            </div>

            <div id="command-status"
                style="margin-top: 15px; padding: 12px; border-radius: 10px; font-size: 13px; font-weight: 600; text-align: center; display: none; background: rgba(35, 134, 54, 0.1); color: var(--success-color); border: 1px solid rgba(35, 134, 54, 0.2);">
                ‚úÖ Command Sent!
            </div>
        </div>

        <!-- NEW: Monetization & Service Tier -->
        <!-- NEW: Monetization & Service Tier -->
        <div
            style="background: rgba(255, 215, 0, 0.05); border: 1px solid #ffd700; border-radius: 20px; padding: 25px; display: flex; justify-content: space-between; align-items: center; gap: 20px;">
            <div style="flex: 1;">
                <h4 style="margin: 0; color: #ffd700; font-size: 18px;">üíé Premium Bulk Service ($1 Only)</h4>
                <p style="margin: 8px 0 0; font-size: 14px; color: var(--text-secondary);">
                    <b>Lucky 7 Deal:</b> Pay just $1 (0.0004 ETH) and the Agent will autonomously deploy <b>7 Verified
                        Smart Contracts</b> for you on Base Mainnet.
                </p>
            </div>
            <div style="display: flex; flex-direction: column; gap: 10px; min-width: 180px;">
                <button onclick="window.open('https://basescan.org/address/0x56c06036521f05Da74519A7c41223A5fF239C6BF')"
                    style="background: #ffd700; color: #000; width: 100%; font-weight: 800;">‚ö° SEND FEE ($1)</button>
                <div style="font-size: 11px; text-align: center; color: #ffd700; opacity: 0.8; font-weight: 600;">
                    Fee: 0.0004 ETH ($1)</div>
            </div>
        </div>

        <!-- History -->
        <div class="token-list">
            <div class="list-header">üõ°Ô∏è Verify Deployment History (On-chain)</div>
            <div id="deployment-history">
                <div id="empty-state" style="padding: 60px; text-align: center; color: var(--text-secondary);">
                    <div style="font-size: 40px; margin-bottom: 10px;">üîç</div>
                    Scanning blockchain for agent signatures...
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div
            style="text-align: center; padding: 40px 0; color: var(--text-secondary); font-size: 13px; border-top: 1px solid var(--border-color);">
            Built for <strong>Base Agent Competition</strong> ‚Ä¢ Powered by <strong>Agent0 SDK</strong> ‚Ä¢ Real-time
            On-chain Execution
        </div>
    </div>

    <script>
        let userAddress = null;
        let provider = null;
        let signer = null;

        const ERC20_ABI = [
            "constructor(string name, string symbol, uint256 initialSupply)",
            "function name() view returns (string)",
            "function symbol() view returns (string)",
            "function totalSupply() view returns (uint256)",
            "function balanceOf(address) view returns (uint256)",
            "function transfer(address to, uint256 amount) returns (bool)",
            "event Transfer(address indexed from, address indexed to, uint256 value)"
        ];

        const ERC20_BYTECODE = "0x608060405234801561001057600080fd5b61012b806100206000396000f3fe608060405234801561001057600080fd5b600436106100415760003560e01c806306fdde031461004657806395d89b4114610064575b600080fd5b610062600480360381019061005d91906100b9565b610082565b60405161007991906100ef565b60405180910390f35b610080600480360381019061007b91906100ef565b6100a7565b6040516100b491906100ef565b60405180910390f35b80600181146100c5575b50565b3373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef81816040516100e491906100ef565b60405180910390a350565b6000819050919050565b60006020828403121561010657610105610121565b5b60003573ffffffffffffffffffffffffffffffffffffffff169050919050565b600080fdfea2646970667358221220abcdef1234567890abcdef1234567890abcdef1234567890abcdef123456789064736f6c63430008120033";

        function agentDesignToken() {
            const prefixes = ["Open", "Base", "Claw", "Auto", "Chain", "Mesh", "Cyber", "Meta", "Hyper", "Ultra", "Mega", "Nova", "Apex", "Quantum", "Nexus"];
            const suffixes = ["Token", "Coin", "Cash", "Finance", "Pay", "Network", "Protocol", "Chain", "Swap", "Vault", "DAO", "Labs"];

            const name = prefixes[Math.floor(Math.random() * prefixes.length)] + suffixes[Math.floor(Math.random() * suffixes.length)];
            const symbol = (name[0] + name[name.length - 2] + name[name.length - 1]).toUpperCase();

            document.getElementById('custom-name').value = name;
            document.getElementById('custom-symbol').value = symbol;

            const status = document.getElementById('command-status');
            status.textContent = "ü™Ñ Agent suggested: " + name;
            status.style.display = 'block';
            setTimeout(() => status.style.display = 'none', 3000);
        }

        async function connectWallet() {
            console.log("Connect Wallet clicked");
            if (typeof window.ethereum !== 'undefined') {
                try {
                    console.log("Ethereum provider found, requesting accounts...");
                    provider = new ethers.providers.Web3Provider(window.ethereum);
                    const accounts = await provider.send("eth_requestAccounts", []);
                    signer = provider.getSigner();
                    userAddress = accounts[0];
                    console.log("Connected address:", userAddress);

                    document.getElementById('user-address').textContent = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                    document.getElementById('connect-wallet').textContent = 'Connected';
                    document.getElementById('connect-wallet').style.background = 'var(--success-color)';
                    document.getElementById('deployment-mode').textContent = 'Mode: User Manual (connected)';
                } catch (error) {
                    console.error("Connection error:", error);
                    alert("Connection failed: " + error.message);
                }
            } else {
                console.warn("MetaMask not found");
                alert("Please install MetaMask or a Web3 wallet extension!");
            }
        }

        async function handleDeploy() {
            if (userAddress && signer) {
                await deployFromUserWallet();
            } else {
                await sendCommand('deploy');
            }
        }

        async function deployFromUserWallet() {
            const name = document.getElementById('custom-name').value || "UserToken";
            const symbol = document.getElementById('custom-symbol').value || "UTK";
            const status = document.getElementById('command-status');
            const btn = document.getElementById('sepolia-free-btn'); // Changed to sepolia-free-btn

            if (!name || !symbol) {
                alert("Please provide name and symbol");
                return;
            }

            try {
                // Network Check - Enforce Sepolia for Free Test
                const { chainId } = await provider.getNetwork();
                console.log("Current Chain ID:", chainId);

                if (chainId !== 84532) {
                    alert("‚ö†Ô∏è Network Mismatch!\n\nFor the 'Free Sepolia Test', you must be on Base Sepolia (Chain ID: 84532).\n\nPlease switch your wallet network.");
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: '0x14a34' }], // 84532 in hex
                        });
                    } catch (switchError) {
                        // This error code monitoring is important for user experience
                        if (switchError.code === 4902) {
                            alert("Base Sepolia network is not added to your wallet. Please add it manually.");
                        }
                    }
                    return;
                }

                btn.disabled = true;
                btn.textContent = "‚åõ Deploying 5 Tokens...";
                status.style.display = 'block';

                const factory = new ethers.ContractFactory(ERC20_ABI, ERC20_BYTECODE, signer);
                // Use a smaller initial supply
                const initialSupply = ethers.utils.parseUnits("1000000", 18);

                // Get initial nonce
                let startingNonce = await provider.getTransactionCount(userAddress);

                // Loop for 5 Sepolia Deployments
                for (let i = 1; i <= 5; i++) {
                    const currentName = i === 1 ? name : `${name} ${i}`;
                    const currentSymbol = i === 1 ? symbol : `${symbol}${i}`;

                    status.textContent = `‚è≥ Sepolia Deployment ${i}/5: Signing...`;

                    try {
                        // Explicit nonce management + gas
                        const contract = await factory.deploy(currentName, currentSymbol, initialSupply, {
                            gasLimit: 3000000,
                            nonce: startingNonce + (i - 1)
                        });

                        status.textContent = `‚è≥ Sepolia Deployment ${i}/5: Submitted...`;

                        // We do NOT wait for full confirmation for speed, just broadcast
                        // Or wait if stability is preferred. Let's wait for at least one confirmation.
                        await contract.deployed();
                        console.log(`Sepolia Token ${i} deployed:`, contract.address);
                    } catch (loopError) {
                        console.error(`Error on token ${i}:`, loopError);
                        // If one fails, we try to continue or just log it
                        status.textContent = `‚ö†Ô∏è Token ${i} failed, continuing...`;
                    }
                }

                status.textContent = "‚úÖ Success! 5 Tokens Deployed on Base Sepolia.";
                document.getElementById('custom-name').value = '';
                document.getElementById('custom-symbol').value = '';

                setTimeout(() => {
                    status.style.display = 'none';
                }, 15000);

            } catch (error) {
                console.error("Deployment failed", error);
                status.textContent = "‚ùå Error: " + (error.data?.message || error.message || "Unknown Error");
                status.style.background = "rgba(255, 0, 0, 0.1)";
                status.style.color = "#ff4a4a";
                alert("Deployment failed! Check status bar for details.");
            } finally {
                btn.disabled = false;
                btn.textContent = "üß™ Free Sepolia Test (5 Tokens)";
            }
        }

        async function payAndDeploy() {
            if (!userAddress || !signer) {
                alert("Please connect wallet first!");
                return;
            }

            const name = document.getElementById('custom-name').value || "PremiumToken";
            const symbol = document.getElementById('custom-symbol').value || "PRM";
            const status = document.getElementById('command-status');
            const btn = document.getElementById('mainnet-pay-btn');

            try {
                // Network check: Must be on Base Mainnet to pay
                const { chainId } = await provider.getNetwork();

                // Signal Agent to deploy on Mainnet using Agent Funds
                await sendCommand('deploy_premium', { name, symbol, tx_hash: tx.hash });

            } catch (error) {
                console.error("Payment failed", error);
                status.textContent = "‚ùå Service Error: " + (error.message || "Payment Failed");
                btn.disabled = false;
                btn.textContent = "üöÄ Deploy on Mainnet ($1 ETH)";
            }
        }

        async function handleBatchDeploy() {
            if (!userAddress || !signer) {
                alert("Please connect your wallet first!");
                return;
            }

            const status = document.getElementById('command-status');
            const btn = document.getElementById('batch-deploy-btn');

            try {
                // Check Balance (0.1$ is approx 0.00004 ETH)
                const balance = await provider.getBalance(userAddress);
                const minBalance = ethers.utils.parseEther("0.00004");

                if (balance.lt(minBalance)) {
                    alert("Insufficient Balance! You need at least 0.1$ (approx 0.00004 ETH) for gas.");
                    return;
                }

                if (!confirm("Agent will design and deploy 5 tokens from your wallet. Continue?")) return;

                btn.disabled = true;
                btn.textContent = "‚åõ Batch Processing...";
                status.style.display = 'block';

                for (let i = 1; i <= 5; i++) {
                    // Agent Designs the token
                    const prefixes = ["Open", "Base", "Claw", "Auto", "Chain", "Mesh", "Cyber", "Meta", "Hyper", "Ultra", "Mega", "Nova", "Apex", "Quantum", "Nexus"];
                    const suffixes = ["Token", "Coin", "Cash", "Finance", "Pay", "Network", "Protocol", "Chain", "Swap", "Vault", "DAO", "Labs"];
                    const name = prefixes[Math.floor(Math.random() * prefixes.length)] + suffixes[Math.floor(Math.random() * suffixes.length)];
                    const symbol = (name[0] + name[name.length - 2] + name[name.length - 1]).toUpperCase();

                    status.textContent = `üöÄ Processing ${i}/5: Deploying ${name}...`;

                    const factory = new ethers.ContractFactory(ERC20_ABI, ERC20_BYTECODE, signer);
                    const initialSupply = ethers.utils.parseUnits("1000000", 18);

                    const contract = await factory.deploy(name, symbol, initialSupply, {
                        gasLimit: 1200000
                    });

                    status.textContent = `‚è≥ Waiting for #${i} Confirmation...`;
                    await contract.deployed();
                    console.log(`Token ${i} deployed at:`, contract.address);
                }

                status.textContent = "‚úÖ All 5 Agent-Designed Tokens Deployed Successfully!";
                status.style.background = "rgba(35, 134, 54, 0.2)";

            } catch (error) {
                console.error("Batch Failed", error);
                status.textContent = "‚ùå Batch Error: " + (error.message || "Unknown Error");
                status.style.background = "rgba(255, 0, 0, 0.1)";
            } finally {
                btn.disabled = false;
                btn.textContent = "üíé Batch Deploy 5 (Agent AI Designs - Manual Wallet)";
                updateDashboard();
            }
        }

        async function sendCommand(type, extraParams = {}) {
            const name = document.getElementById('custom-name').value;
            const symbol = document.getElementById('custom-symbol').value;
            const msg = document.getElementById('custom-message').value;
            const img = document.getElementById('image-url').value;

            const cmd = {
                type: type,
                params: {
                    name, symbol, text: msg, image_url: img, ...extraParams
                },
                timestamp: new Date().toISOString(),
                executed: false
            };

            try {
                const response = await fetch('/api/command', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(cmd)
                });

                if (response.ok) {
                    status.style.display = 'block';
                    setTimeout(() => status.style.display = 'none', 3000);
                    if (type === 'deploy') {
                        document.getElementById('custom-name').value = '';
                        document.getElementById('custom-symbol').value = '';
                    } else if (type === 'post') {
                        document.getElementById('custom-message').value = '';
                        document.getElementById('image-url').value = '';
                    }
                }
            } catch (e) {
                console.error('Command failed', e);
            }
        }

        async function updateDashboard() {
            try {
                const depResponse = await fetch('deployments.json');
                const deployments = await depResponse.json();

                let metadata = { agent_id: '...', reputation: 0 };
                try {
                    const metaResponse = await fetch('agent0_metadata.json');
                    metadata = await metaResponse.json();
                } catch (e) { }

                document.getElementById('total-deployments').textContent = deployments.length;
                document.getElementById('reputation-score').textContent = deployments.length;

                const historyEl = document.getElementById('deployment-history');
                if (deployments.length > 0) {
                    historyEl.innerHTML = '';
                    [...deployments].reverse().forEach(dep => {
                        const date = new Date(dep.timestamp).toLocaleString();
                        const row = document.createElement('div');
                        row.className = 'token-item';
                        row.innerHTML = `
                            <div>
                                <div class="token-name">${dep.token_name || dep.name}</div>
                                <div class="token-symbol">$${dep.token_symbol || dep.symbol}</div>
                            </div>
                            <div class="token-timestamp">${date}</div>
                            <div>
                                <span class="reputation-badge">Verified Proof</span>
                                <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Tx: ${dep.transaction_hash.substring(0, 10)}...</div>
                            </div>
                            <div>
                                <a href="${dep.explorer_url || ('https://basescan.org/tx/' + dep.transaction_hash)}" target="_blank" class="token-link">View Explorer ‚Üó</a>
                            </div>
                        `;
                        historyEl.appendChild(row);
                    });
                }
            } catch (error) {
                console.error('Error updating dashboard:', error);
            }
        }

        updateDashboard();
        setInterval(updateDashboard, 5000);
    </script>
</body>

</html>